(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{51:function(e,t,a){},53:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a(26),c=a.n(n),s=(a(51),a(3)),o=a.n(s),i=a(6),u=a(9),l=(a(53),a(15)),d=a(18),p=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},j=function(){var e=p(1,100);return e<=2?"Verde":e<=51?"Rojo":"Negro"},b=new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}),m=a(2),f=function(e){var t,a=e.user;return Object(m.jsxs)("tr",{className:a.winner?"winnerRow":"looserRow",children:[Object(m.jsx)("td",{children:(null===a||void 0===a||null===(t=a.playerId)||void 0===t?void 0:t.username)||"Usuario eliminado"}),Object(m.jsx)("td",{children:b.format(a.previousCash)}),Object(m.jsx)("td",{children:b.format(a.bet)}),Object(m.jsx)("td",{children:a.betColor}),Object(m.jsx)("td",{children:a.winner?"Ganador":"Perdedor"}),Object(m.jsx)("td",{children:b.format(a.lostOrProfit)}),Object(m.jsx)("td",{children:b.format(a.previousCash+a.lostOrProfit)})]})},h=function(e){var t=e.game,a=e.length,r=e.index;return Object(m.jsxs)("div",{className:"gameResultContainer",children:[0===r&&Object(m.jsx)("h2",{children:"\xdaltima Ronda"}),Object(m.jsxs)("div",{className:"tableHeader",children:[Object(m.jsxs)("h2",{children:["Color Ganador: ",Object(m.jsx)("span",{className:"".concat(t.winnerColor.toLowerCase()),children:t.winnerColor})]}),Object(m.jsxs)("h2",{children:["Juego N\xb0 ",a-r]})]}),Object(m.jsxs)("table",{className:"tableResult",children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Jugador"}),Object(m.jsx)("th",{children:"Dinero antes de apuesta"}),Object(m.jsx)("th",{children:"Dinero apostado"}),Object(m.jsx)("th",{children:"Color apuesta"}),Object(m.jsx)("th",{children:"\xbfGana?"}),Object(m.jsx)("th",{children:"Ganancia / P\xe9rdida"}),Object(m.jsx)("th",{children:"Dinero Actual"})]})}),Object(m.jsx)("tbody",{children:t.players.map((function(e){return Object(m.jsx)(f,{user:e},e._id)}))})]})]})},O=a(14),x=a.n(O),y=function(e,t){x.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(e){e.addEventListener("mouseenter",x.a.stopTimer),e.addEventListener("mouseleave",x.a.resumeTimer)}}).fire({icon:e,title:t})},v=a(8),w=a(17),g=a.n(w),E="https://ruletapp-dansep.herokuapp.com",C={getGames:function(){return function(){var e=Object(i.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(E,"/api/games"));case 2:if((a=e.sent).data.success){e.next=5;break}throw new Error("Ocurri\xf3 un problema. Intente m\xe1s tarde.");case 5:t({type:"GET_GAMES",payload:a.data.response});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},newGameReq:function(){return function(e){e({type:"NEW_GAME_REQ"})}},createNewGame:function(e){return function(){var t=Object(i.a)(o.a.mark((function t(a){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.post("".concat(E,"/api/games"),e);case 2:if((r=t.sent).data.success){t.next=5;break}throw new Error("Ocurri\xf3 un problema. Intente m\xe1s tarde.");case 5:return a({type:"CREATE_GAME",payload:r.data.response.game}),a({type:"GET_PLAYERS",payload:r.data.response.players}),t.abrupt("return",r);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},getWeather:function(){return Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("http://dataservice.accuweather.com/forecasts/v1/daily/5day/60449?apikey=14A2YVwlmMm7UGT4emqoLMAVtejUAvzZ&details=false");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))}},P=C,k=a(16),N=a(45),G="https://ruletapp-dansep.herokuapp.com",R={getPlayers:function(){return function(){var e=Object(i.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("".concat(G,"/api/users"));case 2:if((a=e.sent).data.success){e.next=5;break}throw new Error("Ocurri\xf3 un problema. Intente m\xe1s tarde.");case 5:t({type:"GET_PLAYERS",payload:a.data.response});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},createPlayer:function(e){return function(){var t=Object(i.a)(o.a.mark((function t(a){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.post("".concat(G,"/api/users"),e);case 2:if((r=t.sent).data.success){t.next=5;break}throw new Error(r.data.error);case 5:return a({type:"CREATE_PLAYER",payload:r.data.response}),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},deletePlayer:function(e){return function(){var t=Object(i.a)(o.a.mark((function t(a){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.delete("".concat(G,"/api/user/").concat(e));case 2:if((r=t.sent).data.success){t.next=5;break}throw new Error(r.data.error);case 5:return a({type:"DELETE_PLAYER",payload:e}),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},editPlayer:function(e,t,a){return function(){var r=Object(i.a)(o.a.mark((function r(n){var c;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.a.put("".concat(G,"/api/user/").concat(e),t);case 2:if((c=r.sent).data.success){r.next=5;break}throw new Error(c.data.error);case 5:return n(a?{type:"CHANGE_DATA",payload:{id:e,user:c.data.response}}:{type:"EDIT_PLAYER",payload:{id:e,newData:t,user:c.data.response}}),r.abrupt("return",c);case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},addCash:function(){return function(){var e=Object(i.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.put("".concat(G,"/api/users"));case 2:if((a=e.sent).data.success){e.next=5;break}throw new Error(a.data.error);case 5:return t({type:"GET_PLAYERS",payload:a.data.response}),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},A=R,_={createNewGame:P.createNewGame,getWeather:P.getWeather,addCash:A.addCash},T=Object(v.b)((function(e){return{games:e.games.games,newGameReq:e.games.newGameReq,players:e.players.players,chosenPlayers:e.players.chosenPlayers,cleanGame:e.games.cleanGame}}),_)((function(e){var t=e.games,a=e.newGameReq,n=e.createNewGame,c=e.getWeather,s=e.chosenPlayers,b=e.cleanGame,f=e.addCash,O=Object(r.useState)(!1),v=Object(u.a)(O,2),w=v[0],g=v[1],E=Object(r.useState)(!1),C=Object(u.a)(E,2),P=C[0],G=C[1],R=Object(r.useState)({players:[],winnerColor:""}),A=Object(u.a)(R,2),_=A[0],T=A[1],I=function(){var e=Object(i.a)(o.a.mark((function e(){var t,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c();case 3:if(200!==(t=e.sent).status){e.next=10;break}a=(t.data.DailyForecasts[2].Temperature.Maximum.Value-32)/1.8,r=(t.data.DailyForecasts[3].Temperature.Maximum.Value-32)/1.8,G(a>20&&r>20),e.next=11;break;case 10:throw new Error("Problemas para obtener el clima. Intente m\xe1s tarde.");case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),y("error",e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){document.title="RuletApp - Inicio",window.scrollTo(0,0)}),[]);Object(r.useEffect)((function(){T({players:[],winnerColor:""}),I(),function(e){var t=[];s.map((function(a){var r=a.cash>1e3?P?p(3,7):p(8,15):100;r=Math.round(r*a.cash/100);var n,c=j(),s=c===e;n="Verde"===e&&s?15*r:s?2*r:-1*r;var o={playerId:a._id,betColor:c,previousCash:a.cash,bet:r,winner:s,lostOrProfit:n,newCash:a.cash+n};return t.push(o),!0})),T({winnerColor:e,players:t})}(j())}),[s,b]);var D=function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(_);case 3:(t=e.sent).data.success?y("success","Partida guardada."):y("error",t.data.error),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),y("error",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){w?D():g(!0)}),[a]);return Object(m.jsxs)("main",{className:"mainContainer",children:[Object(m.jsxs)("div",{className:"buttonSection",children:[Object(m.jsx)(d.b,{to:"/jugadores",className:"startButton",children:Object(m.jsxs)("span",{className:"buttonContent",children:[Object(m.jsx)(k.g,{})," Ver jugadores"]})}),Object(m.jsxs)("span",{className:"buttonContent startButton",onClick:function(){x.a.fire({title:"\xbfDesea finalizar el d\xeda?",text:"Todos los jugadores recibir\xe1n $10.000",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirmar",cancelButtonText:"Cancelar"}).then((function(e){if(e.isConfirmed){var t=function(){var e=Object(i.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f();case 3:t=e.sent,a=t.data.success?["Completado","Todos los jugadores recibieron $10.000","success"]:["Ocurri\xf3 un problema","Intente m\xe1s tarde","error"],x.a.fire(a[0],a[1],a[2]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),x.a.fire("Ocurri\xf3 un problema","Intente m\xe1s tarde","error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();t()}}))},children:[Object(m.jsx)(N.a,{})," Finalizar D\xeda"]})]}),Object(m.jsx)("h1",{className:"results",children:"Resultados"}),Object(l.a)(t).reverse().map((function(e,a){return Object(m.jsx)(h,{game:e,length:t.length,index:a},e._id)}))]})})),I=a(28),D=a(4),S=function(e){var t,a,r=e.picture,n=e.player,c=e.setNewPlayer,s=e.editMode,o=e.user;return a=s&&(null===o||void 0===o?void 0:o.image.includes(r))||(null===n||void 0===n||null===(t=n.image)||void 0===t?void 0:t.includes(r))?"picture selected":"picture",Object(m.jsx)("div",{onClick:function(){c(Object(D.a)(Object(D.a)({},n),{},{image:"/assets/".concat(r,".png")}))},className:a,style:{backgroundImage:"url('/assets/".concat(r,".png')")}})},B={createPlayer:A.createPlayer,editPlayer:A.editPlayer},M=Object(v.b)(null,B)((function(e){var t=e.setModal,a=e.createPlayer,n=e.editMode,c=e.playerData,s=e.editPlayer,l=Object(r.useState)({}),d=Object(u.a)(l,2),p=d[0],j=d[1],f=function(e){j(Object(D.a)(Object(D.a)({},p),{},Object(I.a)({},e.target.name,e.target.value)))},h=function(){var e=Object(i.a)(o.a.mark((function e(){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p.username){e.next=3;break}throw new Error("Ingrese su nombre de usuario.");case 3:if(p.image){e.next=5;break}throw new Error("Seleccione una imagen.");case 5:return e.next=7,a(p);case 7:(r=e.sent).data.success?(y("success","Jugador creado exitosamente"),t(!1)):y("error",r.data.error),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),y("error",e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(p).length){e.next=4;break}y("info","No tienes cambios para guardar"),e.next=14;break;case 4:return e.prev=4,e.next=7,s(c._id,p,"form");case 7:(t=e.sent).data.success?y("success","Cambios guardados."):y("error",t.data.error),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),y("error",e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{className:"newPlayer",children:Object(m.jsxs)("div",{className:"modal",children:[Object(m.jsx)("img",{className:"closeIcon",src:"/assets/close.png",alt:"Close Icon",onClick:function(){return t(!1)}}),Object(m.jsx)("h2",{children:"Seleccione un avatar"}),Object(m.jsx)("div",{className:"picturesContainer",children:["avatar1","avatar2","avatar3","avatar4","avatar5","avatar6"].map((function(e){return Object(m.jsx)(S,{picture:e,player:p,setNewPlayer:j,editMode:!0,user:c},e)}))}),Object(m.jsx)("label",{htmlFor:"username",children:"Nombre de Usuario"}),Object(m.jsx)("input",{id:"username",name:"username",onChange:f,defaultValue:n&&c.username}),Object(m.jsx)("label",{htmlFor:"cash",children:n?"Dinero Actual":"Dinero Inicial"}),Object(m.jsx)("input",{id:"cash",name:"cash",disabled:!n,defaultValue:n?c.cash:b.format(1e4),onChange:f}),Object(m.jsx)("div",{className:"startButton",onClick:n?function(){return O()}:function(){return h()},children:n?"Guardar cambios":"Crear Usuario"})]})})})),L={deletePlayer:A.deletePlayer,editPlayer:A.editPlayer},q=Object(v.b)(null,L)((function(e){var t=e.player,a=e.deletePlayer,n=e.editPlayer,c=Object(r.useState)(!1),s=Object(u.a)(c,2),l=s[0],d=s[1],p=function(){var e=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a(t._id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),y("error",e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),j=function(e){if(0===t.cash)return x.a.fire("No se puede realizar esta acci\xf3n.","El usuario debe tener un saldo mayor a $0 para poder jugar.","warning");n(t._id,"remove"===e?{active:!1}:{active:!0})},f=t.active?"card selectedCard":"card";return Object(m.jsxs)("div",{className:f,children:[t.active?Object(m.jsx)(k.b,{className:"selectedTrue",onClick:function(){return j("remove")}}):Object(m.jsx)(k.c,{className:"selectedIcon",onClick:function(){return j("add")}}),Object(m.jsx)("div",{className:"picture",style:{backgroundImage:"url('".concat(t.image,"')")}}),Object(m.jsx)("h3",{children:"Nombre"}),Object(m.jsx)("h4",{children:t.username}),Object(m.jsx)("h3",{children:"Dinero"}),Object(m.jsx)("h4",{children:b.format(t.cash)}),Object(m.jsxs)("div",{className:"icons",children:[Object(m.jsx)(k.f,{className:"editIcon",onClick:function(){return d(!0)}}),Object(m.jsx)(k.d,{className:"deleteIcon",onClick:function(){x.a.fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede revertir",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Borrar",cancelButtonText:"Cancelar"}).then((function(e){e.isConfirmed&&(p(),x.a.fire("Eliminado","Se ha eliminado a ".concat(t.username),"success"))}))}})]}),l&&Object(m.jsx)(M,{setModal:d,editMode:!0,playerData:t})]})})),Y=Object(v.b)((function(e){return{players:e.players.players,chosenPlayers:e.players.chosenPlayers}}))((function(e){var t=e.players,a=e.chosenPlayers,n=Object(r.useState)(!1),c=Object(u.a)(n,2),s=c[0],o=c[1];return Object(r.useEffect)((function(){document.title="RuletApp - Jugadores",window.scrollTo(0,0)}),[]),Object(m.jsxs)("section",{className:"playersSection",children:[Object(m.jsx)(d.b,{to:"/",className:"startButton",children:Object(m.jsxs)("span",{className:"buttonContent",children:[Object(m.jsx)(k.e,{})," Inicio"]})}),Object(m.jsxs)("h1",{children:["Seleccionar jugadores (",a.length,")"]}),Object(m.jsxs)("div",{className:"playersContainer",children:[Object(m.jsx)("div",{className:"card",children:Object(m.jsx)(k.a,{className:"plusIcon",onClick:function(){return o(!0)}})}),Object(l.a)(t).reverse().map((function(e){return Object(m.jsx)(q,{player:e},e._id)})),s&&Object(m.jsx)(M,{setModal:o})]})]})})),V={newGameReq:P.newGameReq},F=Object(v.b)(null,V)((function(e){var t=e.newGameReq,a=Object(r.useState)(180),n=Object(u.a)(a,2),c=n[0],s=n[1],o=new Date(1e3*c).toISOString().substr(14,5);return setTimeout((function(){s(0===c?180:c-1)}),1e3),Object(r.useEffect)((function(){0===c&&t()}),[c]),Object(m.jsx)("div",{className:"temp",children:Object(m.jsxs)("h1",{children:["Pr\xf3xima ronda dentro de ",o]})})})),J=function(){return Object(m.jsxs)("div",{className:"notFound",children:[Object(m.jsx)("img",{src:"/assets/lost.png",alt:"",style:{width:"30%"}}),Object(m.jsx)("h2",{style:{marginBottom:"2vh"},children:"Esta p\xe1gina no existe."}),Object(m.jsx)(d.b,{to:"/",className:"startButton",children:"Volver a Inicio"})]})},W=a(5),U={getGames:P.getGames,getPlayers:A.getPlayers},z=Object(v.b)(null,U)((function(e){var t=Object(r.useState)(!0),a=Object(u.a)(t,2),n=a[0],c=a[1],s=function(){var t=Object(i.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getGames();case 3:return t.next=5,e.getPlayers();case 5:c(!1),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),y("error",t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();return Object(r.useEffect)((function(){s()}),[]),n?Object(m.jsxs)("div",{className:"loader",children:[Object(m.jsx)("img",{className:"loaderImage",src:"/assets/ruleta.png",alt:"Ruleta"}),Object(m.jsx)("h1",{children:"Iniciando aplicaci\xf3n..."})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(F,{}),Object(m.jsx)(d.a,{children:Object(m.jsxs)(W.d,{children:[Object(m.jsx)(W.b,{exact:!0,path:"/",component:T}),Object(m.jsx)(W.b,{path:"/jugadores",component:Y}),Object(m.jsx)(W.b,{path:"/notfound",component:J}),Object(m.jsx)(W.a,{to:"/notfound"})]})})]})})),H=a(23),$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{games:[],newGameReq:!0,cleanGame:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_GAMES":return Object(D.a)(Object(D.a)({},e),{},{games:t.payload});case"NEW_GAME_REQ":return Object(D.a)(Object(D.a)({},e),{},{newGameReq:!e.newGameReq});case"CREATE_GAME":return Object(D.a)(Object(D.a)({},e),{},{games:[].concat(Object(l.a)(e.games),[t.payload]),cleanGame:!e.cleanGame});default:return e}},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{players:[],chosenPlayers:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_PLAYERS":return Object(D.a)(Object(D.a)({},e),{},{players:t.payload,chosenPlayers:t.payload.filter((function(e){return e.active}))});case"CREATE_PLAYER":return Object(D.a)(Object(D.a)({},e),{},{players:[].concat(Object(l.a)(e.players),[t.payload]),chosenPlayers:[].concat(Object(l.a)(e.chosenPlayers),[t.payload])});case"DELETE_PLAYER":return Object(D.a)(Object(D.a)({},e),{},{players:e.players.filter((function(e){return e._id!==t.payload})),chosenPlayers:e.chosenPlayers.filter((function(e){return e._id!==t.payload}))});case"EDIT_PLAYER":return Object(D.a)(Object(D.a)({},e),{},{players:e.players.map((function(e){return e._id===t.payload.id?Object(D.a)(Object(D.a)({},e),{},{active:t.payload.newData.active}):e})),chosenPlayers:t.payload.newData.active?[].concat(Object(l.a)(e.chosenPlayers),[t.payload.user]):e.chosenPlayers.filter((function(e){return e._id!==t.payload.id}))});case"CHANGE_DATA":return Object(D.a)(Object(D.a)({},e),{},{players:e.players.map((function(e){return e._id===t.payload.id?t.payload.user:e}))});default:return e}},Z=Object(H.b)({games:$,players:Q}),K=a(46),X=Object(H.c)(Z,Object(H.a)(K.a));c.a.render(Object(m.jsx)(v.a,{store:X,children:Object(m.jsx)(z,{})}),document.getElementById("root"))}},[[92,1,2]]]);
//# sourceMappingURL=main.7f92df8d.chunk.js.map